LOAD EMPLOYEE
SSN_SAL <- PROJECT Ssn, Salary FROM EMPLOYEE
Q1 <- SELECT Salary >= 30000 FROM SSN_SAL
EXPORT Q1 

LOAD EMPLOYEE
CROSS_EMPLOYEE <- CROSS EMPLOYEE EMPLOYEE
Q2_IM <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM CROSS_EMPLOYEE
Q2_IM1 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM Q2_IM
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE1_Super_ssn, EMPLOYEE1_Bdate FROM Q2_IM1
EXPORT Q2

LOAD EMPLOYEE
LOAD WORKS_ON
CROSS_WORKSON_EMP <- CROSS WORKS_ON EMPLOYEE
Q3_IM <- SELECT Essn == Ssn FROM CROSS_WORKSON_EMP
Q3_IM1 <- PROJECT Pno, Ssn, Sex FROM Q3_IM
CROSS_Q3_IM1 <- CROSS Q3_IM1 Q3_IM1
Q3_IM2 <- SELECT Q3_IM11_Pno == Q3_IM12_Pno FROM CROSS_Q3_IM1
Q3_IM3 <- SELECT Q3_IM11_Ssn != Q3_IM12_Ssn FROM Q3_IM2
Q3_IM4 <- SELECT Q3_IM11_Sex != Q3_IM12_Sex FROM Q3_IM3
Q3 <- PROJECT Q3_IM11_Pno FROM Q3_IM4
RENAME Q3_IM11_Pno TO Pno FROM Q3
EXPORT Q3

LOAD WORKS_ON
CROSS_WORKSON <- CROSS WORKS_ON WORKS_ON
Q4_IM <- SELECT WORKS_ON1_Pno == WORKS_ON2_Pno FROM CROSS_WORKSON
Q4_IM1 <- PROJECT WORKS_ON1_Pno, WORKS_ON1_Essn, WORKS_ON2_Essn FROM Q4_IM
LOAD EMPLOYEE
Q4_IM2 <- CROSS Q4_IM1 EMPLOYEE
Q4_IM3 <- SELECT WORKS_ON1_Essn == Ssn FROM Q4_IM2
Q4_IM4 <- SELECT WORKS_ON2_Essn == Super_ssn FROM Q4_IM3
Q4 <- PROJECT Ssn, Super_ssn, WORKS_ON1_Pno FROM Q4_IM4
RENAME WORKS_ON1_Pno TO Pno FROM Q4
EXPORT Q4
